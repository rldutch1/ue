select ;into "nl:"
distinct(l.location_cd),
facility_name = uar_get_code_display(l.location_cd) ;facility name
, Facility_Code = uar_get_code_display(l.facility_accn_prefix_cd)

from
	location   l
	, location   lo
	, code_value cv1
	, code_value cv_lo

plan l
	where	l.location_type_cd = 783.00 ;facility(s)
	and		l.active_ind = 1
	and		l.patcare_node_ind = 1

; 	and l.location_cd =  4298880175.00	;bumcs

join lo
	where	lo.organization_id = l.organization_id
	and 	lo.active_ind = 1
	and		lo.location_type_cd = 794.00 ;nurse unit(s)

join cv1
	where	cv1.code_value = l.location_cd
	and		cv1.display_key not in ("BANNERHEALTH","STARTORGANIZAT","BPC")

join cv_lo
	where	cv_lo.code_value = lo.location_cd
;	and		cv_lo.display not in ("*TEST*","*TEST*") ;enabled when go live

order by
	facility_name

with nocounter, format, time=30
